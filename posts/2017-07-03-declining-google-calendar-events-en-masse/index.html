<!doctype html><html lang=en-us><head><title>Holiday time - bulk declining Google Calendar events // Jason Madigan</title>
<link rel="shortcut icon" href=/favicon.ico><meta charset=utf-8><meta name=generator content="Hugo 0.140.2"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Jason Madigan"><meta name=description content><link rel=stylesheet href=/css/main.min.5b1fcc8902588589c4767187402a3c29f8b8d7a6fdef6d9f8f77045bb0d14fee.css><meta name=twitter:card content="summary"><meta name=twitter:title content="Holiday time - bulk declining Google Calendar events"><meta name=twitter:description content="I’m getting married in a few weeks, so recently I wanted a way to decline about 3 weeks worth of Google Calendar events en-masse. Since I was using Google Apps for our organisation’s calendar, I found the easiest way to accomplish this was to bust out some Google Apps Scripting, which lets you script a number of Google Apps in your domain, including the Calendar.
See an example below on how to bulk decline Google Calendar events using Google Apps Scripting - you’ll just need a calendar name & a date range and run this via the script console:"><meta property="og:url" content="/posts/2017-07-03-declining-google-calendar-events-en-masse/"><meta property="og:site_name" content="Jason Madigan"><meta property="og:title" content="Holiday time - bulk declining Google Calendar events"><meta property="og:description" content="I’m getting married in a few weeks, so recently I wanted a way to decline about 3 weeks worth of Google Calendar events en-masse. Since I was using Google Apps for our organisation’s calendar, I found the easiest way to accomplish this was to bust out some Google Apps Scripting, which lets you script a number of Google Apps in your domain, including the Calendar.
See an example below on how to bulk decline Google Calendar events using Google Apps Scripting - you’ll just need a calendar name & a date range and run this via the script console:"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-07-03T19:00:00+00:00"><meta property="article:modified_time" content="2017-07-03T19:00:00+00:00"></head><body><header class=app-header><a href=/><img class=app-header-avatar src=/0.jpg alt="Jason Madigan"></a>
<span class=app-header-title>Jason Madigan</span><nav class=app-header-menu><a class=app-header-menu-item href=/about/>About</a></nav><p>He's just zis guy, ya know?</p><div class=app-header-social><a href=https://github.com/jasonmadigan target=_blank rel="noreferrer noopener me"><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-link"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg>
</a><a href=https://twitter.com/jasonmadigan target=_blank rel="noreferrer noopener me"><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-link"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg></a></div></header><main class=app-container><article class=post><header class=post-header><h1 class=post-title>Holiday time - bulk declining Google Calendar events</h1><div class=post-meta><div><svg class="icon icon-calendar" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
Jul 3, 2017</div><div><svg class="icon icon-clock" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>clock</title><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
2 min read</div></div></header><div class=post-content><p>I&rsquo;m getting married in a few weeks, so recently I wanted a way to decline about 3 weeks worth of Google Calendar events en-masse. Since I was using Google Apps for our organisation&rsquo;s calendar, I found the easiest way to accomplish this was to bust out some <a href=https://www.google.com/script/start/>Google Apps Scripting</a>, which lets you script a number of Google Apps in your domain, including the <a href=https://developers.google.com/apps-script/reference/calendar/calendar-event>Calendar</a>.</p><p>See an example below on how to bulk decline Google Calendar events using Google Apps Scripting - you&rsquo;ll just need a calendar name & a date range and run this via the script console:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>GCalHoliday</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>fromDate</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Date(<span style=color:#e6db74>&#39;July 17, 2017 00:00:00 +0100&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>toDate</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Date(<span style=color:#e6db74>&#39;August 8, 2017 23:30:00 +0100&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>calendarName</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&lt;Your Calendar - e.g. joe@bloggs.com&gt;&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>calendar</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>CalendarApp</span>.<span style=color:#a6e22e>getCalendarsByName</span>(<span style=color:#a6e22e>calendarName</span>)[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>events</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>calendar</span>.<span style=color:#a6e22e>getEvents</span>(<span style=color:#a6e22e>fromDate</span>, <span style=color:#a6e22e>toDate</span>, {});
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Logger</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Events: &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>events</span>.<span style=color:#a6e22e>length</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>events</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>ev</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>events</span>[<span style=color:#a6e22e>i</span>];
</span></span><span style=display:flex><span>    <span style=color:#75715e>// try/catch for setting status - may get exceptions where events 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// are on calendar, but user is not a &#34;guest&#34; of the event - these can be ignored
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// !!!
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#75715e>// ev.setMyStatus(CalendarApp.GuestStatus.NO); // Uncomment to actually update status
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#75715e>// !!!
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>e</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Logger</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Error updating event status &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>e</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Logger</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Item &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>getTitle</span>() <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39; found on &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>ev</span>.<span style=color:#a6e22e>getStartTime</span>() <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39; marked as declined&#39;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div><div class=post-footer></div></article></main></body></html>